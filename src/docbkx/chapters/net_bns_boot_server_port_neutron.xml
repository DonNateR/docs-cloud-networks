<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE section [
        <!-- Some useful entities borrowed from HTML -->
        <!ENTITY ndash  "&#x2013;">
        <!ENTITY mdash  "&#x2014;">
        <!ENTITY hellip "&#x2026;">
        
        <!-- Useful for describing APIs -->
        <!ENTITY GET    '<command xmlns="http://docbook.org/ns/docbook">GET</command>'>
        <!ENTITY PUT    '<command xmlns="http://docbook.org/ns/docbook">PUT</command>'>
        <!ENTITY POST   '<command xmlns="http://docbook.org/ns/docbook">POST</command>'>
        <!ENTITY DELETE '<command xmlns="http://docbook.org/ns/docbook">DELETE</command>'>     
<!ENTITY fgCS 'first generation Cloud Servers'>
<!ENTITY ngCS 'next generation Cloud Servers'>
<!ENTITY cnresource1 'rax-networks'>
<!ENTITY virt_ext 'Cloud Networks virtual interface extension'>
<!ENTITY cnresource2 'os-networksv2'>
]>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:raxm="http://docs.rackspace.com/api/metadata" version="5.0"
    xml:id="boot_server_with_port_network_neutron">
    <!-- Need to apply all of sameer's steps -->
    <!-- =================================== -->
    <!-- 1. create new port 
         2. list ports
         3. boot server
         4. show port                        -->
    
    <title>Provision a server by attaching a port with an isolated network</title>
    <para>To create your new server using this procedure, first create a port. </para>

    <sidebar>
        <para><emphasis role="bold">Next step:</emphasis> Choose one of the following methods:<itemizedlist>
                <listitem>
                    <para><olink targetdoc="cn-gettingstarted" targetptr="neutron_boot_server_neutron">“Provision a server with an
                            isolated network with the neutron client”</olink></para>
                </listitem>
                <listitem>
                    <para><olink targetdoc="cn-gettingstarted" targetptr="curl_boot_server_neutron">“Provision a server with an
                            isolated network with cURL”</olink></para>
                </listitem>
            </itemizedlist></para>
    </sidebar>

    <?hard-pagebreak?>
    <section xml:id="neutron_boot_server_neutron">
        <title>Provision a server with an isolated network with the nova client</title>
        <para>
            <procedure>
                <title>To provision a server and attach an isolated network</title>
                <step>
                    <para>Issue the following nova client command:
                        <programlisting language="bash" role="gutter: false">
                            <prompt>$</prompt> nova boot my_server_with_network --flavor 2 --image d42f821e-c2d1-4796-9f07-af5ed7912d0e --nic net-id=e65accc0-1d98-45eb-af76-ab3d31edc7d2</programlisting></para>
                    <?sbr?>
                    <para><emphasis role="bold">Output:</emphasis> The command returns information about the new server, as
                        shown in the following output:</para>
                    <informalexample>
                        <screen><computeroutput>+-------------------------+--------------------------------------+
| Property                | Value                                |
+-------------------------+--------------------------------------+
| OS-DCF:diskConfig       | AUTO                                 |
| OS-EXT-STS:power_state  | 0                                    |
| OS-EXT-STS:task_state   | scheduling                           |
| OS-EXT-STS:vm_state     | building                             |
| accessIPv4              |                                      |
| accessIPv6              |                                      |
| adminPass               | abababababab                         |
| created                 | 2012-10-04T18:07:56Z                 |
| flavor                  | 512MB Standard Instance              |
| hostId                  |                                      |
| id                      | 72859427-1e74-4a4f-b6b5-f547c1c3d452 |
| image                   | Fedora 17 (Beefy Miracle)            |
| metadata                | {}                                   |
| name                    | my_server_with_network               |
| progress                | 0                                    |
| status                  | BUILD                                |
| tenant_id               | 010101                               |
| updated                 | 2012-10-04T18:07:56Z                 |
| user_id                 | 170454                               |
+-------------------------+--------------------------------------+</computeroutput></screen>
                    </informalexample>

                </step>
            </procedure>
        </para>
        <sidebar>
            <para><emphasis role="bold">Next step:</emphasis>
                <olink targetdoc="cn-gettingstarted" targetptr="list_servers">“Step 2. List servers and attached
                    networks”</olink></para>
        </sidebar>
    </section>
    <?hard-pagebreak?>
    <section xml:id="curl_boot_server_neutron">
        <title>Provision a server with an isolated network with cURL</title>
        <section xml:id="json_boot_server_neutron">
            <title>JSON request and response</title>
            <procedure>
                <title>To provision a server with an isolated network to the server</title>
                <step>
                    <para>Issue the following cURL
                        command:<programlisting language="bash" role="gutter: false"><?db-font-size 55%?>
                            <prompt>$</prompt> curl https://dfw.servers.api.rackspacecloud.com/v2/$account/servers \
         -X POST \
         -H "X-Auth-Project-Id: $account" \
         -H "Content-Type: application/json" \
         -H "Accept: application/json" \
         -H "X-Auth-Token: $token" \
         -d '{"server": {"name": "my_server_with_network", "imageRef": "d42f821e-c2d1-4796-9f07-af5ed7912d0e", "flavorRef": "2", "max_count": 1, "min_count": 1, "networks": [{"uuid": "538a112a-34d1-47ff-bf1e-c40639e886e2"}, {"uuid": "00000000-0000-0000-0000-000000000000"}, {"uuid": "11111111-1111-1111-1111-111111111111"}]}}' \
         | python -m json.tool</programlisting></para>
                    <para>In addition to the isolated network, PublicNet and ServiceNet are attached to the server. You must
                        explicitly specify these networks to attach them to your server.</para>
                    <para><emphasis role="bold">Output:</emphasis> The API operation returns information about the new
                        server, as shown in the following output:</para>
                    <programlisting language="json"><?db-font-size 65%?>
                        <xi:include href="../../common/samples/server-post-resp.json" parse="text"/></programlisting>
                </step>
            </procedure>
            <sidebar>
                <para><emphasis role="bold">Next step:</emphasis>
                    <olink targetdoc="cn-gettingstarted" targetptr="list_servers">“Step 2. List servers and attached
                        networks”</olink></para>
            </sidebar>
        </section>
        <section xml:id="xml_boot_server_neutron">
            <title>XML request and response</title>
            <procedure>
                <title>To provision a server and attach an isolated network to the server</title>
                <step>
                    <para>Issue the following cURL
                        command:<programlisting language="bash" role="gutter: false"><?db-font-size 55%?>
                            <prompt>$</prompt> curl -i https://dfw.servers.api.rackspacecloud.com/v2/$account/servers.xml \
        -X POST \
        -H "X-Auth-Project-Id: $account" \
        -H "Content-Type: application/xml" \
        -H "Accept: application/xml" \
        -H "X-Auth-Token: $token" \
        -d '&lt;?xml version="1.0" encoding="UTF-8"?>&lt;server xmlns="http://docs.openstack.org/compute/api/v1.1" imageRef="3afe97b2-26dc-49c5-a2cc-a2fc8d80c001" flavorRef="2" name="api-test-server-xml2">&lt;metadata>&lt;meta key="My Server Name">API Test Server XML&lt;/meta>&lt;/metadata>&lt;networks>&lt;uuid>0ef47ac7-6797-4e01-8a47-ed26ec3aaa56&lt;/uuid>&lt;uuid>00000000-0000-0000-0000-000000000000&lt;/uuid>&lt;uuid>11111111-1111-1111-1111-111111111111&lt;/uuid>&lt;/networks>&lt;/server>'</programlisting></para>
                    <para>In addition to the isolated network, PublicNet and ServiceNet are attached to the server. You must
                        explicitly specify these networks to attach them to your server.</para>
                    <para><emphasis role="bold">Output:</emphasis> The API operation returns information about the new
                        server, as shown in the following output:</para>
                    <programlisting language="xml"><?db-font-size 65%?><xi:include href="../../common/samples/server-post-resp.xml" parse="text"/></programlisting>
                </step>
            </procedure>
            <sidebar>
                <para><emphasis role="bold">Next step:</emphasis>
                    <olink targetdoc="cn-gettingstarted" targetptr="list_servers">“Step 2. List servers and attached
                        networks”</olink></para>
            </sidebar>
        </section>
    </section>
    <?hard-pagebreak?>
</section>
