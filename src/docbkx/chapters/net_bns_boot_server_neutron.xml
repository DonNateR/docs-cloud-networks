<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE section [
        <!-- Some useful entities borrowed from HTML -->
        <!ENTITY ndash  "&#x2013;">
        <!ENTITY mdash  "&#x2014;">
        <!ENTITY hellip "&#x2026;">
        
        <!-- Useful for describing APIs -->
        <!ENTITY GET    '<command xmlns="http://docbook.org/ns/docbook">GET</command>'>
        <!ENTITY PUT    '<command xmlns="http://docbook.org/ns/docbook">PUT</command>'>
        <!ENTITY POST   '<command xmlns="http://docbook.org/ns/docbook">POST</command>'>
        <!ENTITY DELETE '<command xmlns="http://docbook.org/ns/docbook">DELETE</command>'>     
<!ENTITY fgCS 'first generation Cloud Servers'>
<!ENTITY ngCS 'next generation Cloud Servers'>
<!ENTITY cnresource1 'rax-networks'>
<!ENTITY virt_ext 'Cloud Networks virtual interface extension'>
<!ENTITY cnresource2 'os-networksv2'>
]>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:raxm="http://docs.rackspace.com/api/metadata" version="5.0"
    xml:id="boot_server_with_network_neutron">
    <title>Provision a server by directly attaching an isolated network</title>
    <para>To create your new server and attach an isolated network, you need the following information: </para>

    <itemizedlist>
        <listitem>
            <para>The name of the new server. Use a name of your choice.</para>
        </listitem>
        <listitem>
            <para>The image ID. For how to list images, see
                <link xlink:href="http://docs.rackspace.com/servers/api/v2/cs-gettingstarted/content/list_images.html">
                    List Images</link>.</para>
        </listitem>
        <listitem>
            <para>The flavor ID. For how to list flavors, see
                <link xlink:href="http://docs.rackspace.com/servers/api/v2/cs-gettingstarted/content/list_flavors.html">
                    List Flavors</link>.</para>
        </listitem>
        <listitem>
            <para>The network ID of your isolated network. This is the ID you copied in <olink targetdoc="cn-gettingstarted"
                    targetptr="create_network_neutron">“Create a network or a sub-network”</olink></para>
        </listitem>
    </itemizedlist>

    <para>You specify these values as parameters in a nova command or as attributes in the request body in a cURL
        command.</para>
    <note security="external">
        <para>You cannot attach an isolated network to an existing server. However, to work around this limitation, you can
            create an image of the server and build a new server based on that image. When you build the new server, you can
            attach the isolated network. For information, see
            <link xlink:href="http://www.rackspace.com/knowledge_center/article/attach-an-existing-cloud-server-to-a-cloud-network">
                <citetitle>Attach a Cloud Network to an Existing Cloud Server</citetitle></link>.
            To use the create image API, see
            <link xlink:href="http://docs.rackspace.com/servers/api/v2/cs-devguide/content/Create_Image-d1e4655.html">
                Create Image</link>.</para>
    </note>
    <sidebar>
        <para><emphasis role="bold">Next step:</emphasis> Choose one of the following methods:<itemizedlist>
                <listitem>
                    <para><olink targetdoc="cn-gettingstarted" targetptr="neutron_provision_server_neutron">“Provision a
                            server with an isolated network with the nova client”</olink></para>
                </listitem>
                <listitem>
                    <para><olink targetdoc="cn-gettingstarted" targetptr="curl_provision_server_neutron">“Provision a server
                            with an isolated network with cURL”</olink></para>
                </listitem>
            </itemizedlist></para>
    </sidebar>

    <?hard-pagebreak?>
    <section xml:id="neutron_provision_server_neutron">
        <title>Provision a server with an isolated network with the nova client</title>
        <para>
            <procedure>
                <title>To provision a server and attach an isolated network</title>
                <step>
                    <para>Issue the following nova client command:
                        <programlisting language="bash" role="gutter: false"><?db-font-size 50%?>
                            <prompt>$</prompt>  nova boot ServerAmp --image 82e72de5-6366-4217-8c87-a570a9b17e73 --nic net-id=29f52c7e-6efd-4335-a14a-db77d32a2555 --flavor 1</programlisting></para>
                    <para><emphasis role="bold">Output:</emphasis> The command returns information about the new server, as
                        shown in the following output:</para>
                    <informalexample>
                        <screen><computeroutput>
+--------------------------------------+-----------------------------------------------------------------+
| Property                             | Value                                                           |
+--------------------------------------+-----------------------------------------------------------------+
| OS-DCF:diskConfig                    | MANUAL                                                          |
| OS-EXT-AZ:availability_zone          | nova                                                            |
| OS-EXT-STS:power_state               | 0                                                               |
| OS-EXT-STS:task_state                | scheduling                                                      |
| OS-EXT-STS:vm_state                  | building                                                        |
| OS-SRV-USG:launched_at               | -                                                               |
| OS-SRV-USG:terminated_at             | -                                                               |
| accessIPv4                           |                                                                 |
| accessIPv6                           |                                                                 |
| adminPass                            | K3kviaHwhKqS                                                    |
| config_drive                         |                                                                 |
| created                              | 2014-02-06T20:05:12Z                                            |
| flavor                               | m1.tiny (1)                                                     |
| hostId                               |                                                                 |
| id                                   | fbcebd8c-5b4f-4087-a778-f5a6ffc4530f                            |
| image                                | cirros-0.3.0-x86_64-disk (82e72de5-6366-4217-8c87-a570a9b17e73) |
| key_name                             | -                                                               |
| metadata                             | {}                                                              |
| name                                 | ServerAmp                                                       |
| os-extended-volumes:volumes_attached | []                                                              |
| progress                             | 0                                                               |
| security_groups                      | default                                                         |
| status                               | BUILD                                                           |
| tenant_id                            | 53501b3c25d34f8ea293c03298caed60                                |
| updated                              | 2014-02-06T20:05:12Z                                            |
| user_id                              | 28be72f8fc5b45589c93f55274e459ce                                |
+--------------------------------------+-----------------------------------------------------------------+
</computeroutput></screen>
                    </informalexample>

                </step>
            </procedure>
        </para>
        <sidebar>
            <para><emphasis role="bold">Next step:</emphasis>
                <olink targetdoc="cn-gettingstarted" targetptr="list_servers">“List servers and attached
                networks”</olink></para>
        </sidebar>
    </section>
    <?hard-pagebreak?>
    <section xml:id="curl_provision_server_neutron">
        <title>Provision a server with an isolated network with cURL</title>
        <section xml:id="json_create_server_neutron">
            <title>JSON request and response</title>
            <procedure>
                <title>To provision a server with an isolated network to the server</title>
                <step>
                    <para>Issue the following cURL
                        command:<programlisting language="bash" role="gutter: false"><?db-font-size 55%?>
                            <prompt>$</prompt> curl https://dfw.servers.api.rackspacecloud.com/v2/$account/servers \
         -X POST \
         -H "X-Auth-Project-Id: $account" \
         -H "Content-Type: application/json" \
         -H "Accept: application/json" \
         -H "X-Auth-Token: $token" \
         -d '{"server": {"name": "ServerAmp", "imageRef": "82e72de5-6366-4217-8c87-a570a9b17e73", "flavorRef": "1", "max_count": 1, "min_count": 1, "networks": [{"uuid": "29f52c7e-6efd-4335-a14a-db77d32a2555"}, {"uuid": "00000000-0000-0000-0000-000000000000"}, {"uuid": "11111111-1111-1111-1111-111111111111"}]}}' \
         | python -m json.tool</programlisting></para>
                    <para>In addition to the isolated network, PublicNet and ServiceNet are attached to the server. You must
                        explicitly specify these networks to attach them to your server.</para>
                    <para><emphasis role="bold">Output:</emphasis> The API operation returns information about the new
                        server, as shown in the following output:</para>
                    <programlisting language="json"><?db-font-size 65%?>
{
    "server": {
        "OS-DCF:diskConfig": "MANUAL", 
        "adminPass": "K3kviaHwhKqS", 
        "id": "fbcebd8c-5b4f-4087-a778-f5a6ffc4530f", 
        "links": [
            {
                "href": "https://dfw.servers.api.rackspacecloud.com/v2/010101/servers/fbcebd8c-5b4f-4087-a778-f5a6ffc4530f", 
                "rel": "self"
            }, 
            {
                "href": "https://dfw.servers.api.rackspacecloud.com/010101/servers/fbcebd8c-5b4f-4087-a778-f5a6ffc4530f", 
                "rel": "bookmark"
            }
        ]
    }
}    
                    </programlisting>
                </step>
            </procedure>
            <sidebar>
                <para><emphasis role="bold">Next step:</emphasis>
                    <olink targetdoc="cn-gettingstarted" targetptr="list_servers">“List servers and attached
                        networks”</olink></para>
            </sidebar>
        </section>
        <section xml:id="xml_create_server_neutron">
            <title>XML request and response</title>
            <procedure>
                <title>To provision a server and attach an isolated network to the server</title>
                <step>
                    <para>Issue the following cURL
                        command:<programlisting language="bash" role="gutter: false"><?db-font-size 55%?>
                            <prompt>$</prompt> curl -i https://dfw.servers.api.rackspacecloud.com/v2/$account/servers.xml \
        -X POST \
        -H "X-Auth-Project-Id: $account" \
        -H "Content-Type: application/xml" \
        -H "Accept: application/xml" \
        -H "X-Auth-Token: $token" \
        -d '&lt;?xml version="1.0" encoding="UTF-8"?>&lt;server xmlns="http://docs.openstack.org/compute/api/v1.1" imageRef="82e72de5-6366-4217-8c87-a570a9b17e73" flavorRef="1" name="ServerAmp">&lt;networks>&lt;uuid>29f52c7e-6efd-4335-a14a-db77d32a2555&lt;/uuid>&lt;uuid>00000000-0000-0000-0000-000000000000&lt;/uuid>&lt;uuid>11111111-1111-1111-1111-111111111111&lt;/uuid>&lt;/networks>&lt;/server>'</programlisting></para>
                    <para>In addition to the isolated network, PublicNet and ServiceNet are attached to the server. You must
                        explicitly specify these networks to attach them to your server.</para>
                    <para><emphasis role="bold">Output:</emphasis> The API operation returns information about the new
                        server, as shown in the following output:</para>
                    <programlisting language="xml"><?db-font-size 65%?>
&lt;server>
    xmlns:OS-DCF="http://docs.openstack.org/compute/ext/disk_config/api/v1.1"
    xmlns:atom="http://www.w3.org/2005/Atom"
    xmlns="http://docs.openstack.org/compute/api/v1.1"
    id="ed5c7754-29b6-45fa-96cb-ab64958c8c0a" adminPass="Dd5pNZtpVVQ3"
    OS-DCF:diskConfig="AUTO">
    &lt;metadata/>
    &lt;atom:link
        href="https://dfw.servers.api.rackspacecloud.com/v2/010101/servers/ed5c7754-29b6-45fa-96cb-ab64958c8c0a"
        rel="self"/>
    &lt;atom:link
        href="https://dfw.servers.api.rackspacecloud.com/010101/servers/ed5c7754-29b6-45fa-96cb-ab64958c8c0a"
        rel="bookmark"/>
&lt;/server>
                    </programlisting>
                </step>
            </procedure>
            <sidebar>
                <para><emphasis role="bold">Next step:</emphasis>
                    <olink targetdoc="cn-gettingstarted" targetptr="list_servers">“List servers and attached
                        networks”</olink></para>
            </sidebar>
        </section>
    </section>
    <?hard-pagebreak?>
</section>
